import os
import sys
import shutil

junk_file_names = [
	".gitignore", ".gitattributes", "README.md", "LICENSE", "ChangeLog.md", "phpunit.xml",
    ".travis.yml", "readmd.md", ".php_cs.dist", "ChangeLog-5.7.md", "phpunit.xsd",
    "CHANGELOG.md", "CODE_OF_CONDUCT.md", "CONTRIBUTING.md", ".php_cs", ".travis.install.sh", "ChangeLog-2.2.md",
    "ChangeLog-3.0.md", "ChangeLog-3.1.md", "ChangeLog-3.2.md", "ChangeLog-3.3.md", "ChangeLog-3.4.md",
    "ChangeLog-4.0.md", ".converalls.yml", ".CONTRIBUTING.md", ".scrutinizer.yml", "CHANGES.md", ".stickler.yml",
    "ChangeLog.md", ".coveralls.yml", "phpunit.xml.dist" , ".styleci.yml", ".composer-auth.json","collect.logo",
	"upgrade.sh","code_of_conduct.md","CODE_OF_CONDUCT.md",".codeclimate.yml",
	"CNAME","LICENCE","collect-logo.png","AUTHORS","yarn-error.log","changelog.md","History.md","LICENCE.txt","license",
	"Changelog.md"
]
def print_vendor_stats():
	vendor_dir = os.path.join(os.getcwd(),"node_modules");
	count = 0
	if os.path.exists(vendor_dir):
		for root, dirs, files in os.walk(vendor_dir):
			for file in files:
				count += 1
	print "num files: " + str(count)
	
def normalize_path(dir):
	return dir.replace('\\',os.sep).replace('/',os.sep)

def delete_dir_if_is_dir(dir):
	if (os.path.isdir(dir)):
		delete_dir(dir)
		
def delete_dir(dir):
	if os.path.exists(dir):
		print "deleting dir: " + dir
		shutil.rmtree(dir)

def delete_file(file):
	if os.path.exists(file):
		print "deleting file: " + file
		os.remove(file)
		
def delete_dirs():
	dir_names = [ 'test','example'];
	vendor_dir = os.path.join(os.getcwd(),"node_modules");
	if os.path.exists(vendor_dir):
		for root, dirs, files in os.walk(vendor_dir):
			for dir in dirs:
				if dir in dir_names:
					print "deleting: "+ dir
					delete_dir_if_is_dir(os.path.join(root,dir))
					
def delete_junk_files():
	global junk_file_names
	vendor_dir = os.path.join(os.getcwd(),"node_modules");
	if os.path.exists(vendor_dir):
		for root, dirs, files in os.walk(vendor_dir):
			for file in files:
				if file in junk_file_names:
					print "deleting: " + file
					delete_file(os.path.join(root,file))
		
if __name__ == "__main__":
	# walk_vendor_dir()
	print_vendor_stats()
	delete_dirs()
	delete_junk_files()
	print_vendor_stats()
	raw_input("Press Enter to continue...")
	
	
